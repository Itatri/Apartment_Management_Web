
<!DOCTYPE html>
<html>

<head>
    <!-- Basic -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- Mobile Metas -->
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <!-- Site Metas -->
    <meta name="keywords" content="" />
    <meta name="description" content="" />
    <meta name="author" content="" />

    <title>IT APARTMENT</title>

    <!-- bootstrap core css -->
    <link rel="stylesheet" type="text/css" href="~/css/bootstrap.css" />

    <link href="https://fonts.googleapis.com/css?family=Poppins:400,700&display=swap" rel="stylesheet">
    <!-- Custom styles for this template -->
    <link href="~/css/style.css" rel="stylesheet" />
    <!-- responsive style -->
    <link href="~/css/responsive.css" rel="stylesheet" />

    
     <link href="~/css/user-profile.css" rel="stylesheet" />






<!-- Bootstrap Datepicker CSS -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css" rel="stylesheet">

<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!-- Bootstrap Datepicker JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">



</head>

       <body className='snippet-body'>
                             

                                </body>

                                    <body class="sub_page">
                                        <div class="hero_area">
                                            <!-- header section strats -->
                                            <header class="header_section">
                                                <div class="container-fluid">
                                                    <nav class="navbar navbar-expand-lg custom_nav-container">
                                                        <a class="navbar-brand" href="@Url.Action("HomePage", "Home")">
                                                            <img src="~/images/apartment.png" alt="" />
                                                            <span>
                                                                IT APARTMENT
                                                            </span>
                                                        </a>
                                                        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                                                            <span class="navbar-toggler-icon"></span>
                                                        </button>



                                                             <div class="collapse navbar-collapse" id="navbarSupportedContent">

                                                            <ul class="navbar-nav">
                                                                <li class="nav-item active">
                                                                    <a class="nav-link" href="@Url.Action("HomePage", "Home")">Trang chủ <span class="sr-only">(current)</span></a>
                                                                </li>
                                                               @*  <li class="nav-item">
                                                                    <a class="nav-link" href="@Url.Action("AboutPages", "About")">Về chúng tôi</a>
                                                                </li> *@
                                                                @*    <li class="nav-item">
                                                                    <a class="nav-link" href="@Url.Action("WorkPages", "Work")">Tra cứu</a>
                                                                </li> *@
                                                                <li class="nav-item">
                                                                    <a class="nav-link" href="@Url.Action("FeedbackPage", "Feedback")">Phản hồi</a>
                                                                </li>
                                                                <li class="nav-item">
                                                                    <a class="nav-link" href="@Url.Action("InputBill", "Bill")">Hóa đơn</a>
                                                                </li>



                                                            </ul>



                                                            <div class="user_option">
                                                                <a href="#">
                                                                    <span>

                                                                    <div class="button-container">
                                                                      <a class="btn btn-secondary" href="@Url.Action("UserProfile", "Login")" role="button">
                                                                         Tài khoản  : &nbsp; <span id="userIdDisplay"></span>
                                                                      </a>
                                                                    </div>

                                                                    </span>

                                                                </a>

                                                                  <span id="logoutBtn" style="cursor: pointer; margin-left: 10px; color: white;">
                                                                    Đăng xuất
                                                                </span> 

                                                                <form class="form-inline my-2 my-lg-0 ml-0 ml-lg-4 mb-3 mb-lg-0">
                                                                    @*  <button class="btn my-2 my-sm-0 nav_search-btn" type="submit"></button> *@
                                                                </form>
                                                            </div>



                                                        </div>
                                                        <div>
                                                            <div class="custom_menu-btn ">
                                                                <button>
                                                                    <span class=" s-1">

                                                                    </span>
                                                                    <span class="s-2">

                                                                    </span>
                                                                    <span class="s-3">

                                                                    </span>
                                                                </button>
                                                            </div>
                                                        </div>

                                                    </nav>
                                                </div>
                                            </header>
                                        </div>

                                            <!-- Phần Danh sách cư dân của phòng -->
                                            <div class="container rounded bg-white mt-5 mb-5">
                                                <div class="row" style="border: 2px solid #ededed;">
                                                    <section class="experience_section layout_padding" style="padding-bottom: 0px; padding-top: 50px;">
                                                        <div class="container">
                                                            <label for="exampleInputEmail1">
                                                                Khách trọ phòng : <span id="maPhongLabel"></span>
                                                            </label>
                                                            <br><br>
                                                            <div class="table-responsive">
                                                                <table class="table">
                                                                    <thead>
                                                                        <tr>
                                                                            <th scope="col" class="hidden-column">Mã cư dân</th>
                                                                            <th scope="col">Họ tên </th>
                                                                            <th scope="col">Giới tính</th>
                                                                            <th scope="col">Ngày sinh</th>
                                                                            <th scope="col">Căn cước công dân</th>
                                                                            <th scope="col">Số điện thoại</th>
                                                                            <th scope="col">Email</th>
                                                                            <th scope="col">Quê quán</th>
                                                                            <th scope="col">Quan hệ</th>
                                                                            <th scope="col">Trạng thái</th>
                                                                            <th scope="col">Hành động</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody id="khachTableBody">
                                                                        <tr>
                                                                            <th scope="row">Trống</th>
                                                                            <td>Trống</td>
                                                                            <td>Trống</td>
                                                                            <td>Trống</td>
                                                                            <td>Trống</td>
                                                                            <td>Trống</td>
                                                                            <td>Trống</td>
                                                                            <td>Trống</td>
                                                                            <td>Trống</td>
                                                                            <td>Trống</td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                            <br />
                                                            <div class="container" style="text-align: center;">
                                                                <button type="button" class="btn btn-primary" onclick="showDetail()">Kê khai thông tin khách mới</button>
                                                            </div>
                                                            <br />
                                                        </div>
                                                    </section>
                                                </div>
                                            </div>


                                        @* Thông tin chi tiết của cư dân *@
                                         @*   <div id="chiTietCuDan" class="container rounded bg-white mt-5 mb-5" style="display: none;"> *@ @*  sử dụng style="display: none; để ẩn Thông tin chi tiết của cư dân *@
                                           <div  class="container rounded bg-white mt-5 mb-5" > @*  sử dụng style="display: none; để ẩn Thông tin chi tiết của cư dân *@
                                        <div class="row" style="border: 2px solid #ededed;">
                                            <div class="col-md-3 border-right">
                                                <div class="d-flex flex-column align-items-center text-center p-3 py-5">
                                                   @*  <img class="mt-5" width="150px" src="~/images/ChuKy.jpg"> *@
                                                   <img class="mt-5 img-chuky" width="150px" src="~/images/signature.png">

                                                
                                                    <span class="text-black-50" id="chuKyName" >default.jpg</span>
                                                        <span class="font-weight-bold">Ảnh chữ ký</span>
                                                    <span> 

                                                    </span>
                                                </div>
                                            </div>
                                            <div class="col-md-5 border-right">
                                                <div class="p-3 py-5">
                                                    <div class="d-flex justify-content-between align-items-center mb-3">
                                                        <h4 class="text-right">Thông Tin Chi Tiết</h4>
                                                    </div>
                                                   @*  <div class="row mt-2">
                                                        <div class="col-md-6"><label class="labels">Name</label><input type="text" class="form-control" placeholder="first name" value=""></div>
                                                        <div class="col-md-6"><label class="labels">Surname</label><input type="text" class="form-control" value="" placeholder="surname"></div>
                                                    </div> *@
                                                    <div class="row mt-3">
                                                        <div class="col-md-12"><label class="labels">Họ Tên </label><input type="text" class="form-control" placeholder="Nhập họ tên" value=""></div>
                                                        @* <div class="col-md-12"><label class="labels">Giới tính</label><input type="text" class="form-control" placeholder="Chọn giới tinh" value=""></div> *@
                                                        <div class="col-md-12">
                                                            <label class="labels">Giới tính</label>
                                                            <select class="form-control">
                                                                <option value="">Chọn giới tính</option> <!-- Tùy chọn mặc định -->
                                                                <option value="Nam">Nam</option>
                                                                <option value="Nu">Nữ</option>
                                                            </select>
                                                        </div>

                                                    @*     <div class="col-md-12"><label class="labels">Ngày Sinh</label><input type="text" class="form-control" placeholder="Chọn ngày sinh" value=""></div> *@

                                                      <div class="col-md-12">
                                                        <label class="labels">Ngày Sinh</label>
                                                        <div class="input-group">
                                                            <input type="text" class="form-control" id="datepicker" placeholder="Chọn ngày sinh" />
                                                            <div class="input-group-append">
                                                                <span class="input-group-text bg-light d-block" id="calendar-icon">
                                                                    <i class="fa fa-calendar"></i> <!-- Icon lịch -->
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </div>




                                                        <div class="col-md-12"><label class="labels">Số Điện Thoại</label><input type="text" class="form-control" placeholder="Nhập số điện thoại" value=""></div>
                                                        <div class="col-md-12"><label class="labels">Email</label><input type="text" class="form-control" placeholder="Nhập email" value=""></div>
                                                        <div class="col-md-12"><label class="labels">Phòng</label><input type="text" class="form-control" placeholder="Thông tin phòng" value=""></div>
                                                         <div class="col-md-12">
                                                            <label class="labels">Quan hệ</label>
                                                            <select class="form-control">
                                                                <option value="">Chọn quan hệ</option> <!-- Tùy chọn mặc định -->
                                                                <option value="Chủ hộ">Chủ hộ</option>
                                                                <option value="Ba">Ba</option>
                                                                <option value="Mẹ">Mẹ</option>
                                                            </select>
                                                        </div>
                                                       @*  <div class="col-md-12"><label class="labels">Email ID</label><input type="text" class="form-control" placeholder="enter email id" value=""></div>
                                                        <div class="col-md-12"><label class="labels">Education</label><input type="text" class="form-control" placeholder="education" value=""></div> *@
                                                    </div>
                                                 @*    <div class="row mt-3">
                                                        <div class="col-md-6"><label class="labels">Country</label><input type="text" class="form-control" placeholder="country" value=""></div>
                                                        <div class="col-md-6"><label class="labels">State/Region</label><input type="text" class="form-control" value="" placeholder="state"></div>
                                                    </div> *@
                                                    <div class="mt-5 text-center"><button class="btn btn-primary profile-button" type="button">Lưu thông tin </button></div>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="p-3 py-5">
                                                    <div class="d-flex justify-content-between align-items-center experience">
                                                        <span>Thông tin CCCD</span>
                                                        <span class="border px-3 p-1 add-experience">
                                                        <i class="fa fa-plus"></i>&nbsp;Chọn ảnh chữ ký
                                                                <input type="file" id="chuKyInput" accept="image/*" style="display: none;" />

                                                        </span>
                                                    </div>
                                                        <br>
                                                    <div class="col-md-12"><label class="labels">Số căn cước</label><input type="text" class="form-control" placeholder="Nhập số căn cước" value=""></div> 
                                                    <div class="col-md-12"><label class="labels">Nơi cấp</label><input type="text" class="form-control" placeholder="Nhập nơi cấp" value=""></div>
                                                     <div class="col-md-12">
                                                            <label class="labels">Quê quán</label>
                                                            <select class="form-control">
                                                                <option value="">Chọn quê quán</option> <!-- Tùy chọn mặc định -->
                                                                <option value="Hà Nội">Hà Nội</option>
                                                                <option value="Hồ Chí Minh">Hồ Chí Minh</option>
                                                            </select>
                                                        </div>

                                                      <div class="col-md-12">
                                                        <label class="labels">Ngày Cấp</label>
                                                        <div class="input-group">
                                                            <input type="text" class="form-control" id="datepicker_ngaycap" placeholder="Chọn ngày cấp" />
                                                            <div class="input-group-append">
                                                                <span class="input-group-text bg-light d-block" id="calendar-icon_ngaycap">
                                                                    <i class="fa fa-calendar"></i> <!-- Icon lịch -->
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    </div>
                                    </div>
                              


                    <!-- Modal tạo phản hồi -->
                    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">Phản hồi dịch vụ</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <form>
                                        <div class="form-group">
                                            <label for="recipient-name" class="col-form-label">Phòng</label>
                                            <input type="text" class="form-control" id="recipient-name" readonly>
                                        </div>
                                        <div class="form-group">
                                            <label for="message-text" class="col-form-label">Nội dung</label>
                                            <textarea class="form-control" id="message-text"></textarea>
                                        </div>
                                    </form>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Hủy</button>
                                    <button type="button" class="btn btn-primary">Đồng ý</button>
                                </div>
                            </div>
                        </div>
                    </div>


                  <!-- Modal thông báo gửi phản hồi thành công --> 
                    <div class="modal" id="successModal" tabindex="-1" role="dialog">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title">Thông báo</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <p>Bạn đã gửi phản hồi thành công!</p>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-primary" data-dismiss="modal">Ok</button>
                                </div>
                            </div>
                        </div>
                    </div>


    <!-- end about section -->
    <!-- info section -->

    <section class="info_section ">
        <div class="info_container layout_padding-top">
            <div class="container">
                <div class="info_top">
                    <div class="info_logo">
                        <img src="~/images/apartment.png" alt="" />
                        <span>

                            IT APARTMENT

                        </span>
                    </div>
                    <div class="social_box">
                        <a href="#">
                            <img src="~/images/fb.png" alt="">
                        </a>
                        <a href="#">
                            <img src="~/images/twitter.png" alt="">
                        </a>
                        <a href="#">
                            <img src="~/images/linkedin.png" alt="">
                        </a>
                        <a href="#">
                            <img src="~/images/instagram.png" alt="">
                        </a>
                        <a href="#">
                            <img src="~/images/youtube.png" alt="">
                        </a>
                    </div>
                </div>

                <div class="info_main">
                    <div class="row">
                        <div class="col-md-3 col-lg-2">
                            <div class="info_link-box">
                                <h5>
                                    Liên kết
                                </h5>
                                <ul>
                                    <li class=" active">
                                        <a class="" href="index.html">Trang chủ <span class="sr-only">(current)</span></a>
                                    </li>
                                    <li class="">
                                        <a class="" href="about.html">Về chúng tôi  </a>
                                    </li>
                                    <li class="">
                                        <a class="" href="work.html">Tra cứu </a>
                                    </li>
                                    <li class="">
                                        <a class="" href="category.html">Phản hồi </a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-md-3 ">
                            <h5>
                                Văn phòng
                            </h5>
                            <p>
                                Tại 163 Tây Thạnh, Tân Phú , Hồ Chí Minh
                            </p>
                        </div>

                        <div class="col-md-3 col-lg-2 offset-lg-1">
                            <h5>
                                Thông tin
                            </h5>
                            <p>
                                Cung cấp dịch vụ căn hộ và hỗ trợ khách hàng sử dụng dịch vụ
                            </p>
                        </div>

                        <div class="col-md-3  offset-lg-1">
                            <div class="info_form ">
                                <h5>
                                    Liên hệ
                                </h5>
                                <form action="">
                                    <input type="email" placeholder="Email">
                                    <button>
                                        Gửi
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-lg-9 col-md-10 mx-auto">
                        <div class="info_contact layout_padding2">
                            <div class="row">
                                <div class="col-md-3">
                                    <a href="#" class="link-box">
                                        <div class="img-box">
                                            <img src="~/images/location.png" alt="">
                                        </div>
                                        <div class="detail-box">
                                            <h6>
                                                Tân Phú
                                            </h6>
                                        </div>
                                    </a>
                                </div>
                                <div class="col-md-4">
                                    <a href="#" class="link-box">
                                        <div class="img-box">
                                            <img src="~/images/mail.png" alt="">
                                        </div>
                                        <div class="detail-box">
                                            <h6>
                                                itapartment@gmail.com
                                            </h6>
                                        </div>
                                    </a>
                                </div>
                                <div class="col-md-5">
                                    <a href="#" class="link-box">
                                        <div class="img-box">
                                            <img src="~/images/call.png" alt="">
                                        </div>
                                        <div class="detail-box">
                                            <h6>
                                                Call +03 89634776
                                            </h6>
                                        </div>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </section>

    <!-- end info section -->
    <!-- footer section -->
    <footer class="container-fluid footer_section ">
        <div class="container">
            <p>
                &copy; <span id="displayDate"></span> All Rights Reserved By
                <a href="https://github.com/Itatri">Itatri</a>
            </p>
        </div>
    </footer>
    <!-- end  footer section -->


    <script src="~/js/jquery-3.4.1.min.js"></script>
    <script src="~/js/bootstrap.js"></script>
    <script src="~/js/custom.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>



     <script>

            $(document).ready(function () {
                // Lấy thông tin loginResponse từ localStorage
                    var loginResponse = JSON.parse(localStorage.getItem('loginResponse'));

                    // Kiểm tra xem loginResponse có tồn tại hay không
                    if (loginResponse) {
                        var user = loginResponse.user;

                        // Hiển thị userId nếu có
                        if (user?.id) {
                            $('#userIdDisplay').text(user.id);
                        }

                        // Các thông tin khác từ loginResponse, nếu cần hiển thị
                        console.log('Token:', loginResponse.token);
                        console.log('User:', user);
                        console.log('Mã phòng:', user?.maPhong);
                        console.log('Trạng thái:', user?.trangThai);

                                // Hiển thị mã phòng
                          var maPhong = user?.maPhong;

                         if (maPhong) {
                            $('#maPhongLabel').text(maPhong);
                            // Gọi API để lấy thông tin khách theo mã phòng
                            $.ajax({
                                url: 'https://localhost:7298/api/ThongTinKhaches/GetThongTinKhachByPhong',
                                type: 'GET',
                                data: { maPhong: maPhong },
                                success: function (response) {
                                    if (response.isSuccess && response.khachs && response.khachs.length > 0) {
                                        var khachTableBody = $('#khachTableBody');
                                        khachTableBody.empty(); // Xóa nội dung cũ trong bảng

                                        // Lặp qua danh sách khách và thêm từng hàng vào bảng
                                        response.khachs.forEach(function (khach) {

                                             var trangThaiClass = khach.trangThai ? 'text-success' : 'text-danger';
                                             var trangThaiText = khach.trangThai ? 'Đang cư trú' : 'Đã rời đi';

                                            var row = `
                                                <tr>
                                                  
                                                    <th scope="row" class="hidden-column">${khach.maKhachTro}</th>  <!-- Thêm class để ẩn cột -->
                                                    <td>${khach.hoTen}</td>
                                                    <td>${khach.gioiTinh}</td>
                                                    <td>${khach.ngaySinh ? new Date(khach.ngaySinh).toLocaleDateString() : 'Trống'}</td>
                                                    <td>${khach.cccd}</td>
                                                    <td>${khach.phone}</td>
                                                    <td>${khach.email}</td>
                                                    <td>${khach.queQuan}</td>
                                                    <td>${khach.quanHe}</td>
                                                      <td class="${trangThaiClass}">${trangThaiText}</td>
                                                    <td><button class="btn btn-primary">Xem chi tiết</button></td>
                                                </tr>
                                            `;
                                            khachTableBody.append(row);
                                        });
                                    } else {
                                        alert(response.message || 'Không tìm thấy thông tin khách.');
                                    }
                                },
                                error: function (error) {
                                    console.error('Đã xảy ra lỗi:', error);
                                    alert('Không thể lấy thông tin khách.');
                                }
                            });
                        } else {
                            $('#maPhongLabel').text('Không tìm thấy mã phòng');
                        }

                    }


                    // Xử lý sự kiện nhấn vào nút Đăng xuất
                    $('#logoutBtn').on('click', function () {
                        localStorage.removeItem('loginResponse');
                        console.log('loginResponse:', localStorage.getItem('loginResponse'));
                        window.location.href = '@Url.Action("HomePage", "Home")';
                    });

                    var loginResponse = JSON.parse(localStorage.getItem('loginResponse'));
                    var maPhong = loginResponse?.user?.maPhong; 

                    if (maPhong) {
                        $('#maPhongLabel').text(maPhong);
                    } else {
                        $('#maPhongLabel').text('Không tìm thấy mã phòng');
                    }



                        // Gọi API để lấy thông tin khách theo mã khách trọ
                        $.ajax({
                            url: 'https://localhost:7298/api/ThongTinKhaches/GetThongTinKhachByMaKhachTro',
                            type: 'GET',
                            data: { maKhachTro: 'KT001' },  // Thay 'KT001' bằng mã khách cần lấy
                            success: function (response) {
                                if (response.isSuccess && response.khachs && response.khachs.length > 0) {
                                    var khach = response.khachs[0];  // Lấy thông tin khách đầu tiên trong danh sách

                                    // Đổ dữ liệu vào các trường trên giao diện
                                    $('input[placeholder="Nhập họ tên"]').val(khach.hoTen);
                                  // Sử dụng class để chọn thẻ select
                                    $('select.form-control').val(khach.gioiTinh); // Thay đổi ở đây
                                    $('input[placeholder="Chọn ngày sinh"]').val(new Date(khach.ngaySinh).toLocaleDateString());
                                    $('input[placeholder="Nhập số điện thoại"]').val(khach.phone);
                                    $('input[placeholder="Nhập email"]').val(khach.email);
                                    $('input[placeholder="Thông tin phòng"]').val(khach.maPhong);
                                   // Cập nhật quan hệ
                                      $('select.form-control').eq(1).val(khach.quanHe); 
                                    $('input[placeholder="Nhập số căn cước"]').val(khach.cccd);
                                    $('input[placeholder="Nhập nơi cấp"]').val(khach.noiCap);
                                       // Cập nhật quê quán
                                    $('select.form-control').eq(2).val(khach.queQuan); 
                                    $('input[placeholder="Chọn ngày cấp"]').val(new Date(khach.ngayCap).toLocaleDateString());

                                    // $('.img-chuky').attr('src', '/images/' + khach.chuKy);

                                   // Giả sử khach.chuKy là tên file chữ ký
                                    var chuKyFileName = khach.chuKy || 'default.jpg'; // Nếu không có, đặt tên mặc định

                                    // Cập nhật ảnh và tên
                                    $('.img-chuky').attr('src', '/images/' + chuKyFileName).on('error', function() {
                                        $(this).attr('src', '/images/signature.png'); // Hiển thị ảnh mặc định nếu có lỗi
                                    });

                                    // Cập nhật tên chữ ký
                                    $('#chuKyName').text(chuKyFileName);



                                } else {
                                    alert('Không tìm thấy thông tin khách.');
                                }
                            },
                            error: function (error) {
                                console.error('Đã xảy ra lỗi:', error);
                                alert('Không thể lấy thông tin khách.');
                            }
                        });


                                $(".profile-button").click(function() {
                                        // Lấy giá trị từ các input
                                        const hoTen = $("input[placeholder='Nhập họ tên']").val();
                                        const gioiTinh = $("select[name='gioiTinh']").val();
                                        const ngaySinh = $("#datepicker").val();
                                        const soDienThoai = $("input[placeholder='Nhập số điện thoại']").val();
                                        const email = $("input[placeholder='Nhập email']").val();
                                        const phong = $("input[placeholder='Thông tin phòng']").val();
                                        const quanHe = $("select[name='quanHe']").val();
                                        const soCCCD = $("input[placeholder='Nhập số căn cước']").val();
                                        const noiCap = $("input[placeholder='Nhập nơi cấp']").val();
                                        const queQuan = $("select[name='queQuan']").val();
                                        const ngayCap = $("#datepicker_ngaycap").val();
                                        const chuKyFile = $("#chuKyInput").prop('files')[0]; // Lấy tệp chữ ký

                                        // Tạo đối tượng dữ liệu để gửi
                                        const data = {
                                            HoTen: hoTen,
                                            GioiTinh: gioiTinh,
                                            NgaySinh: ngaySinh,
                                            Phone: soDienThoai,
                                            Email: email,
                                            MaPhong: phong,
                                            QuanHe: quanHe,
                                            CCCD: soCCCD,
                                            NoiCap: noiCap,
                                            QueQuan: queQuan,
                                            NgayCap: ngayCap,
                                            ChuKy: chuKyFile ? chuKyFile.name : null // Nếu có tệp chữ ký
                                        };

                                        // Gọi API
                                        $.ajax({
                                            url: `https://localhost:7298/api/ThongTinKhaches/UpdateThongTinKhach?maKhachTro=KT001`,
                                            type: 'PUT',
                                            contentType: 'application/json',
                                            data: JSON.stringify(data),
                                            success: function(response) {
                                                alert("Cập nhật thông tin thành công!");
                                                console.log(response);
                                            },
                                            error: function(xhr, status, error) {
                                                alert("Cập nhật thông tin thất bại!");
                                                console.error(xhr.responseText);
                                            }
                                        });
                                    });


         
                    // Khai báo Datepicker:
                              // Khởi tạo datepicker cho input
                    $('#datepicker').datepicker({
                        format: 'dd/mm/yyyy', // Định dạng ngày
                        autoclose: true, // Tự động đóng khi chọn
                        todayHighlight: true, // Đánh dấu ngày hiện tại
                        orientation: 'bottom right' // Hiển thị ở góc phải dưới của icon
                    });

                    // Khi click vào icon lịch, kích hoạt datepicker
                    $('#calendar-icon').click(function() {
                        $('#datepicker').datepicker('show'); // Hiển thị datepicker khi nhấn vào icon
                    });
                      $('#datepicker_ngaycap').datepicker({
                        format: 'dd/mm/yyyy', // Định dạng ngày
                        autoclose: true, // Tự động đóng khi chọn
                        todayHighlight: true, // Đánh dấu ngày hiện tại
                        orientation: 'bottom right' // Hiển thị ở góc phải dưới của icon
                    });
                                       // Khi click vào icon lịch, kích hoạt datepicker
                    $('#calendar-icon_ngaycap').click(function() {
                        $('#datepicker_ngaycap').datepicker('show'); // Hiển thị datepicker khi nhấn vào icon
                    });
            });


        </script>




</body>


</html>







